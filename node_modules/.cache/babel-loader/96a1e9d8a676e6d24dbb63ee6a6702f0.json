{"ast":null,"code":"/**\n * Based on ReactArt.js\n * Copyright (c) 2017-present Lavrenov Anton.\n * All rights reserved.\n *\n * MIT\n */\n'use strict';\n\nimport React from 'react';\nimport Konva from 'konva/lib/Core';\nimport ReactFiberReconciler from 'react-reconciler';\nimport { LegacyRoot } from 'react-reconciler/constants';\nimport * as HostConfig from './ReactKonvaHostConfig';\nimport { applyNodeProps, toggleStrictMode } from './makeUpdates';\nimport { useContextBridge, FiberProvider } from 'its-fine';\n\nfunction usePrevious(value) {\n  const ref = React.useRef();\n  React.useLayoutEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\nconst StageWrap = props => {\n  const container = React.useRef();\n  const stage = React.useRef();\n  const fiberRef = React.useRef();\n  const oldProps = usePrevious(props);\n  const Bridge = useContextBridge();\n\n  const _setRef = stage => {\n    const {\n      forwardedRef\n    } = props;\n\n    if (!forwardedRef) {\n      return;\n    }\n\n    if (typeof forwardedRef === 'function') {\n      forwardedRef(stage);\n    } else {\n      forwardedRef.current = stage;\n    }\n  };\n\n  React.useLayoutEffect(() => {\n    stage.current = new Konva.Stage({\n      width: props.width,\n      height: props.height,\n      container: container.current\n    });\n\n    _setRef(stage.current); // @ts-ignore\n\n\n    fiberRef.current = KonvaRenderer.createContainer(stage.current, LegacyRoot, false, null);\n    KonvaRenderer.updateContainer(React.createElement(Bridge, {}, props.children), fiberRef.current);\n    return () => {\n      if (!Konva.isBrowser) {\n        return;\n      }\n\n      _setRef(null);\n\n      KonvaRenderer.updateContainer(null, fiberRef.current, null);\n      stage.current.destroy();\n    };\n  }, []);\n  React.useLayoutEffect(() => {\n    _setRef(stage.current);\n\n    applyNodeProps(stage.current, props, oldProps);\n    KonvaRenderer.updateContainer(React.createElement(Bridge, {}, props.children), fiberRef.current, null);\n  });\n  return React.createElement('div', {\n    ref: container,\n    accessKey: props.accessKey,\n    className: props.className,\n    role: props.role,\n    style: props.style,\n    tabIndex: props.tabIndex,\n    title: props.title\n  });\n};\n\nexport const Layer = 'Layer';\nexport const FastLayer = 'FastLayer';\nexport const Group = 'Group';\nexport const Label = 'Label';\nexport const Rect = 'Rect';\nexport const Circle = 'Circle';\nexport const Ellipse = 'Ellipse';\nexport const Wedge = 'Wedge';\nexport const Line = 'Line';\nexport const Sprite = 'Sprite';\nexport const Image = 'Image';\nexport const Text = 'Text';\nexport const TextPath = 'TextPath';\nexport const Star = 'Star';\nexport const Ring = 'Ring';\nexport const Arc = 'Arc';\nexport const Tag = 'Tag';\nexport const Path = 'Path';\nexport const RegularPolygon = 'RegularPolygon';\nexport const Arrow = 'Arrow';\nexport const Shape = 'Shape';\nexport const Transformer = 'Transformer'; // @ts-ignore\n\nexport const KonvaRenderer = ReactFiberReconciler(HostConfig);\nKonvaRenderer.injectIntoDevTools({\n  // @ts-ignore\n  findHostInstanceByFiber: () => null,\n  bundleType: process.env.NODE_ENV !== 'production' ? 1 : 0,\n  version: React.version,\n  rendererPackageName: 'react-konva'\n});\nexport const Stage = React.forwardRef((props, ref) => {\n  return React.createElement(FiberProvider, {}, React.createElement(StageWrap, { ...props,\n    forwardedRef: ref\n  }));\n});\nexport const useStrictMode = toggleStrictMode;","map":{"version":3,"sources":["/Users/user/Desktop/עבודות להגשה/myweb/node_modules/react-konva/es/ReactKonvaCore.js"],"names":["React","Konva","ReactFiberReconciler","LegacyRoot","HostConfig","applyNodeProps","toggleStrictMode","useContextBridge","FiberProvider","usePrevious","value","ref","useRef","useLayoutEffect","current","StageWrap","props","container","stage","fiberRef","oldProps","Bridge","_setRef","forwardedRef","Stage","width","height","KonvaRenderer","createContainer","updateContainer","createElement","children","isBrowser","destroy","accessKey","className","role","style","tabIndex","title","Layer","FastLayer","Group","Label","Rect","Circle","Ellipse","Wedge","Line","Sprite","Image","Text","TextPath","Star","Ring","Arc","Tag","Path","RegularPolygon","Arrow","Shape","Transformer","injectIntoDevTools","findHostInstanceByFiber","bundleType","process","env","NODE_ENV","version","rendererPackageName","forwardRef","useStrictMode"],"mappings":"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","sourcesContent":["/**\n * Based on ReactArt.js\n * Copyright (c) 2017-present Lavrenov Anton.\n * All rights reserved.\n *\n * MIT\n */\n'use strict';\nimport React from 'react';\nimport Konva from 'konva/lib/Core';\nimport ReactFiberReconciler from 'react-reconciler';\nimport { LegacyRoot } from 'react-reconciler/constants';\nimport * as HostConfig from './ReactKonvaHostConfig';\nimport { applyNodeProps, toggleStrictMode } from './makeUpdates';\nimport { useContextBridge, FiberProvider } from 'its-fine';\nfunction usePrevious(value) {\n    const ref = React.useRef();\n    React.useLayoutEffect(() => {\n        ref.current = value;\n    });\n    return ref.current;\n}\nconst StageWrap = (props) => {\n    const container = React.useRef();\n    const stage = React.useRef();\n    const fiberRef = React.useRef();\n    const oldProps = usePrevious(props);\n    const Bridge = useContextBridge();\n    const _setRef = (stage) => {\n        const { forwardedRef } = props;\n        if (!forwardedRef) {\n            return;\n        }\n        if (typeof forwardedRef === 'function') {\n            forwardedRef(stage);\n        }\n        else {\n            forwardedRef.current = stage;\n        }\n    };\n    React.useLayoutEffect(() => {\n        stage.current = new Konva.Stage({\n            width: props.width,\n            height: props.height,\n            container: container.current,\n        });\n        _setRef(stage.current);\n        // @ts-ignore\n        fiberRef.current = KonvaRenderer.createContainer(stage.current, LegacyRoot, false, null);\n        KonvaRenderer.updateContainer(React.createElement(Bridge, {}, props.children), fiberRef.current);\n        return () => {\n            if (!Konva.isBrowser) {\n                return;\n            }\n            _setRef(null);\n            KonvaRenderer.updateContainer(null, fiberRef.current, null);\n            stage.current.destroy();\n        };\n    }, []);\n    React.useLayoutEffect(() => {\n        _setRef(stage.current);\n        applyNodeProps(stage.current, props, oldProps);\n        KonvaRenderer.updateContainer(React.createElement(Bridge, {}, props.children), fiberRef.current, null);\n    });\n    return React.createElement('div', {\n        ref: container,\n        accessKey: props.accessKey,\n        className: props.className,\n        role: props.role,\n        style: props.style,\n        tabIndex: props.tabIndex,\n        title: props.title,\n    });\n};\nexport const Layer = 'Layer';\nexport const FastLayer = 'FastLayer';\nexport const Group = 'Group';\nexport const Label = 'Label';\nexport const Rect = 'Rect';\nexport const Circle = 'Circle';\nexport const Ellipse = 'Ellipse';\nexport const Wedge = 'Wedge';\nexport const Line = 'Line';\nexport const Sprite = 'Sprite';\nexport const Image = 'Image';\nexport const Text = 'Text';\nexport const TextPath = 'TextPath';\nexport const Star = 'Star';\nexport const Ring = 'Ring';\nexport const Arc = 'Arc';\nexport const Tag = 'Tag';\nexport const Path = 'Path';\nexport const RegularPolygon = 'RegularPolygon';\nexport const Arrow = 'Arrow';\nexport const Shape = 'Shape';\nexport const Transformer = 'Transformer';\n// @ts-ignore\nexport const KonvaRenderer = ReactFiberReconciler(HostConfig);\nKonvaRenderer.injectIntoDevTools({\n    // @ts-ignore\n    findHostInstanceByFiber: () => null,\n    bundleType: process.env.NODE_ENV !== 'production' ? 1 : 0,\n    version: React.version,\n    rendererPackageName: 'react-konva',\n});\nexport const Stage = React.forwardRef((props, ref) => {\n    return React.createElement(FiberProvider, {}, React.createElement(StageWrap, { ...props, forwardedRef: ref }));\n});\nexport const useStrictMode = toggleStrictMode;\n"]},"metadata":{},"sourceType":"module"}