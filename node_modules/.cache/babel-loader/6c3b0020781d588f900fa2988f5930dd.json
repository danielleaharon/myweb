{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { deepEqual } from '../utils/deep-equal';\nexport default class LayerExtension {\n  constructor(opts) {\n    _defineProperty(this, \"opts\", void 0);\n\n    if (opts) {\n      this.opts = opts;\n    }\n  }\n\n  equals(extension) {\n    if (this === extension) {\n      return true;\n    }\n\n    return this.constructor === extension.constructor && deepEqual(this.opts, extension.opts);\n  }\n\n  getShaders(extension) {\n    return null;\n  }\n\n  getSubLayerProps(extension) {\n    const {\n      defaultProps\n    } = extension.constructor;\n    const newProps = {\n      updateTriggers: {}\n    };\n\n    for (const key in defaultProps) {\n      if (key in this.props) {\n        const propDef = defaultProps[key];\n        const propValue = this.props[key];\n        newProps[key] = propValue;\n\n        if (propDef && propDef.type === 'accessor') {\n          newProps.updateTriggers[key] = this.props.updateTriggers[key];\n\n          if (typeof propValue === 'function') {\n            newProps[key] = this.getSubLayerAccessor(propValue);\n          }\n        }\n      }\n    }\n\n    return newProps;\n  }\n\n  initializeState(context, extension) {}\n\n  updateState(params, extension) {}\n\n  draw(params, extension) {}\n\n  finalizeState(context, extension) {}\n\n}\n\n_defineProperty(LayerExtension, \"defaultProps\", {});","map":{"version":3,"sources":["../../../src/lib/layer-extension.ts"],"names":["LayerExtension","constructor","equals","extension","deepEqual","getShaders","getSubLayerProps","defaultProps","newProps","updateTriggers","key","propDef","propValue","initializeState","updateState","draw","finalizeState"],"mappings":";AAmBA,SAAA,SAAA,QAAA,qBAAA;AAMA,eAAe,MAAA,cAAA,CAAoD;AAWjEC,EAAAA,WAAW,CAAA,IAAA,EAAkB;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,MAAA,EAAA,KAAA,CAAA,CAAA;;AAC3B,QAAA,IAAA,EAAU;AACR,WAAA,IAAA,GAAA,IAAA;AACD;AACF;;AAGDC,EAAAA,MAAM,CAAA,SAAA,EAA+C;AACnD,QAAI,SAAJ,SAAA,EAAwB;AACtB,aAAA,IAAA;AACD;;AAED,WAAO,KAAA,WAAA,KAAqBC,SAAS,CAA9B,WAAA,IAA8CC,SAAS,CAAC,KAAD,IAAA,EAAYD,SAAS,CAAnF,IAA8D,CAA9D;AACD;;AAGDE,EAAAA,UAAU,CAAA,SAAA,EAAoC;AAC5C,WAAA,IAAA;AACD;;AAGDC,EAAAA,gBAAgB,CAAA,SAAA,EAA6C;AAC3D,UAAM;AAACC,MAAAA;AAAD,QAAiBJ,SAAS,CAAhC,WAAA;AACA,UAAMK,QAAQ,GAAG;AACfC,MAAAA,cAAc,EAAE;AADD,KAAjB;;AAKA,SAAK,MAAL,GAAA,IAAA,YAAA,EAAgC;AAC9B,UAAIC,GAAG,IAAI,KAAX,KAAA,EAAuB;AACrB,cAAMC,OAAO,GAAGJ,YAAY,CAA5B,GAA4B,CAA5B;AACA,cAAMK,SAAS,GAAG,KAAA,KAAA,CAAlB,GAAkB,CAAlB;AACAJ,QAAAA,QAAQ,CAARA,GAAQ,CAARA,GAAAA,SAAAA;;AACA,YAAIG,OAAO,IAAIA,OAAO,CAAPA,IAAAA,KAAf,UAAA,EAA4C;AAC1CH,UAAAA,QAAQ,CAARA,cAAAA,CAAAA,GAAAA,IAA+B,KAAA,KAAA,CAAA,cAAA,CAA/BA,GAA+B,CAA/BA;;AACA,cAAI,OAAA,SAAA,KAAJ,UAAA,EAAqC;AACnCA,YAAAA,QAAQ,CAARA,GAAQ,CAARA,GAAgB,KAAA,mBAAA,CAAhBA,SAAgB,CAAhBA;AACD;AACF;AACF;AACF;;AAED,WAAA,QAAA;AACD;;AAGDK,EAAAA,eAAe,CAAA,OAAA,EAAA,SAAA,EAA4D,CAAE;;AAE7EC,EAAAA,WAAW,CAAA,MAAA,EAAA,SAAA,EAAsE,CAAE;;AAEnFC,EAAAA,IAAI,CAAA,MAAA,EAAA,SAAA,EAAkD,CAAE;;AAExDC,EAAAA,aAAa,CAAA,OAAA,EAAA,SAAA,EAA4D,CAAE;;AA/DV;;gBAArChB,c,kBAQD,E","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport {deepEqual} from '../utils/deep-equal';\nimport type Layer from './layer';\nimport type CompositeLayer from './composite-layer';\nimport type {UpdateParameters} from './layer';\nimport type {LayerContext} from './layer-manager';\n\nexport default abstract class LayerExtension<OptionsT = undefined> {\n  /**\n   * Note that defaultProps of a LayerExtension does not behave like defaultProps of a Layer:\n      - The default values are not automatically merged with user-supplied props when the layer is constructed\n      - The types are not used during props diff\n   * Currently they are only used in getSubLayerProps\n   * TODO: find a more consistent solution\n   */\n  static defaultProps: any = {};\n  opts!: OptionsT;\n\n  constructor(opts?: OptionsT) {\n    if (opts) {\n      this.opts = opts;\n    }\n  }\n\n  /** Returns true if two extensions are equivalent */\n  equals(extension: LayerExtension<OptionsT>): boolean {\n    if (this === extension) {\n      return true;\n    }\n\n    return this.constructor === extension.constructor && deepEqual(this.opts, extension.opts);\n  }\n\n  /** Only called if attached to a primitive layer */\n  getShaders(this: Layer, extension: this): any {\n    return null;\n  }\n\n  /** Only called if attached to a CompositeLayer */\n  getSubLayerProps(this: CompositeLayer, extension: this): any {\n    const {defaultProps} = extension.constructor as typeof LayerExtension;\n    const newProps = {\n      updateTriggers: {}\n    };\n\n    /* eslint-disable max-depth */\n    for (const key in defaultProps) {\n      if (key in this.props) {\n        const propDef = defaultProps[key];\n        const propValue = this.props[key];\n        newProps[key] = propValue;\n        if (propDef && propDef.type === 'accessor') {\n          newProps.updateTriggers[key] = this.props.updateTriggers[key];\n          if (typeof propValue === 'function') {\n            newProps[key] = this.getSubLayerAccessor(propValue);\n          }\n        }\n      }\n    }\n    /* eslint-enable max-depth */\n    return newProps;\n  }\n\n  /* eslint-disable @typescript-eslint/no-empty-function */\n  initializeState(this: Layer, context: LayerContext, extension: this): void {}\n\n  updateState(this: Layer, params: UpdateParameters<Layer>, extension: this): void {}\n\n  draw(this: Layer, params: any, extension: this): void {}\n\n  finalizeState(this: Layer, context: LayerContext, extension: this): void {}\n}\n"]},"metadata":{},"sourceType":"module"}